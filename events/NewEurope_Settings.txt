add_namespace = ne_settings_intro
add_namespace = ne_settings


##############BPWE: Options/Settings Menu#####################

##DEBUG (HIDDEN)


##Settings Menu
country_event = {
	id = ne_settings_intro.0

	hidden = yes
	is_triggered_only = yes
	fire_only_once = yes

	
	option = { # start settings
		name = ne_settings_intro.1.a	
		
		hidden_effect = {
			country_event = ne_settings_intro.1
		}	
	}

	
}



##Settings Menu
country_event = {
	id = ne_settings_intro.1
	title = ne_settings_intro.1.t
	desc =  ne_settings_intro.1.d
	picture = GFX_report_event_soviet_invasion_map

	is_triggered_only = yes

	
	option = { # Names and Flags + USA/USSR
		name = ne_settings_intro.1.a	
		
		hidden_effect = {
			country_event = ne_settings_intro.2
		}	
	}
	
	
	option = { # neutrality and faction settings
		name = ne_settings_intro.1.b

		hidden_effect = {
			country_event = ne_settings_intro.3
		}
	}
	
	##ne_settings.3 is together with ne_settings.1 !
	
	option = { # misc settings
		name = ne_settings_intro.1.c

		hidden_effect = {
			country_event = ne_settings.5
		}
	}
	
	
	option = { # exit
		name = ne_settings_intro.1.e		
	}
	
	
	
}


##Historical flavor menu
country_event = {
	id = ne_settings_intro.2
	title = ne_settings_intro.2.t
	desc =  ne_settings_intro.2.d
	picture = GFX_report_event_soviet_invasion_map

	is_triggered_only = yes

	
	option = { # Names and Flags
		name = ne_settings_intro.2.a	
		
		hidden_effect = {			
			country_event = ne_settings.1			
		}		
	}
	
	
	option = { # USA/USSR
		name = ne_settings_intro.2.b

		hidden_effect = {
			country_event = ne_settings.3
		}
	}
	
	
	option = { # Return to main menu
		name = ne_settings_intro.2.c

		hidden_effect = {
			country_event = ne_settings_intro.1
		}
	}

	
}


##Neutrality settings and faction settings
country_event = {
	id = ne_settings_intro.3
	title = ne_settings_intro.3.t
	desc =  ne_settings_intro.3.d
	picture = GFX_report_event_soviet_invasion_map

	is_triggered_only = yes

	
	option = { # Neutrality
		name = ne_settings_intro.3.a	
		
		hidden_effect = {			
			country_event = ne_settings.2			
		}		
	}
	
	
	option = { # faction
		name = ne_settings_intro.3.b

		hidden_effect = {
			country_event = ne_settings.4
		}
	}
	
	
	option = { # Return to main menu
		name = ne_settings_intro.3.c

		hidden_effect = {
			country_event = ne_settings_intro.1
		}
	}

	
}



##############Historical Options#####################
country_event = {
	id = ne_settings.1                
	title = ne_settings.1.t   
	desc =  ne_settings.1.d   
	picture = GFX_report_event_soviet_invasion_map

	is_triggered_only = yes

	
	option = {
		name = ne_settings.1.a        #yes
		custom_effect_tooltip = historical_settings_a
		
		trigger = {
			NOT = { has_global_flag = names_chosen }		
		}
		
			GER = {set_cosmetic_tag = DEU}
			JAP = {set_cosmetic_tag = EOJ}
			GRE = {set_cosmetic_tag = NE_GRE}
			WGR = {set_cosmetic_tag = NE_WGR}
			DDR = {set_cosmetic_tag = NE_DDR}
			##these need a tooltip
			KOR = {set_cosmetic_tag = NE_KOR }
			PRC = {set_cosmetic_tag = CSR }
			PAK = {set_cosmetic_tag = NE_PAK }
			SPR = { set_cosmetic_tag = NE_SPR }
			
			hidden_effect = {
				set_global_flag = names_chosen
				country_event = ne_settings_intro.2
			}
	}
	
	option = {
		name = ne_settings.1.a1       #DISABLE the flags and names
		#custom_effect_tooltip = historical_settings_a
		
		trigger = {
			has_global_flag = names_chosen		
		}
		
			GER = { drop_cosmetic_tag = yes }
			JAP = { drop_cosmetic_tag = yes }
			GRE = { drop_cosmetic_tag = yes }
			WGR = { drop_cosmetic_tag = yes }
			DDR = { drop_cosmetic_tag = yes }
			
			hidden_effect = {
				clr_global_flag = names_chosen
				country_event = ne_settings_intro.2
			}
	}
	
	
	option = {	 #ssrs WITHOUT color
		name = ne_settings.1.b       
		custom_effect_tooltip = historical_settings_b
		
		trigger = {
			NOT = { has_global_flag = SSR_chosen }	
		}
		
			##_1 is the version without color!
			LAT = {set_cosmetic_tag = NE_LAT_SSR_1}
			LIT = {set_cosmetic_tag = NE_LIT_SSR_1}
			EST = {set_cosmetic_tag = NE_EST_SSR_1}
			UKR = {set_cosmetic_tag = NE_UKR_SSR_1}
			BLR = {set_cosmetic_tag = NE_BLR_SSR_1}
			GEO = {set_cosmetic_tag = NE_GEO_SSR_1}
			AZR = {set_cosmetic_tag = NE_AZR_SSR_1}
			ARM = {set_cosmetic_tag = NE_ARM_SSR_1}
			KAZ = {set_cosmetic_tag = NE_KAZ_SSR_1}
			UZB = {set_cosmetic_tag = NE_UZB_SSR_1}
			TAJ = {set_cosmetic_tag = NE_TAJ_SSR_1}
			TRK = {set_cosmetic_tag = NE_TRK_SSR_1}
			KGZ = {set_cosmetic_tag = NE_KGZ_SSR_1}
			MOL = {set_cosmetic_tag = NE_MOL_SSR_1}
		
		hidden_effect = {
			set_global_flag = SSR_chosen
			country_event = ne_settings_intro.2
		}
	}
	
	option = {	 #ssrs but WITH color
		name = ne_settings.1.b0     
		custom_effect_tooltip = historical_settings_b
		
		trigger = {
			NOT = { has_global_flag = SSR_chosen }	
		}
		
			##_1 is the version without color!
			LAT = { set_cosmetic_tag = NE_LAT_SSR }
			LIT = { set_cosmetic_tag = NE_LIT_SSR }
			EST = { set_cosmetic_tag = NE_EST_SSR }
			UKR = { set_cosmetic_tag = NE_UKR_SSR }
			BLR = { set_cosmetic_tag = NE_BLR_SSR }
			GEO = { set_cosmetic_tag = NE_GEO_SSR }
			AZR = { set_cosmetic_tag = NE_AZR_SSR }
			ARM = { set_cosmetic_tag = NE_ARM_SSR }
			KAZ = { set_cosmetic_tag = NE_KAZ_SSR }
			UZB = { set_cosmetic_tag = NE_UZB_SSR }
			TAJ = { set_cosmetic_tag = NE_TAJ_SSR }
			TRK = { set_cosmetic_tag = NE_TRK_SSR }
			KGZ = { set_cosmetic_tag = NE_KGZ_SSR }
			MOL = { set_cosmetic_tag = NE_MOL_SSR }
		
		hidden_effect = {
			##might change the global flag 
			set_global_flag = SSR_chosen
			country_event = ne_settings_intro.2
		}
		
	}
	
	option = {	 #DISABLE THE SSRS
		name = ne_settings.1.b1       
		custom_effect_tooltip = historical_settings_b
		
		trigger = {
			has_global_flag = SSR_chosen		
		}
			LAT = {drop_cosmetic_tag = yes }
			LIT = {drop_cosmetic_tag = yes }
			EST = {drop_cosmetic_tag = yes }
			UKR = {drop_cosmetic_tag = yes }
			BLR = {drop_cosmetic_tag = yes }
			GEO = {drop_cosmetic_tag = yes }
			AZR = {drop_cosmetic_tag = yes }
			ARM = {drop_cosmetic_tag = yes }
			KAZ = {drop_cosmetic_tag = yes }
			UZB = {drop_cosmetic_tag = yes }
			TAJ = {drop_cosmetic_tag = yes }
			TRK = {drop_cosmetic_tag = yes }
			KGZ = {drop_cosmetic_tag = yes }
			MOL = {drop_cosmetic_tag = yes }
		
		hidden_effect = {
			clr_global_flag = SSR_chosen
			country_event = ne_settings_intro.2
		}
	}

	
	option = {
		name = ne_settings.1.e        #go back to the menu (no changes done)
		#add_political_power = -1
		
		trigger = {
		
			NOT = {
				has_global_flag = names_chosen
				has_global_flag = SSR_chosen
			}		
		}
		
		hidden_effect = {
			country_event = ne_settings_intro.2
		}
		
	}

	option = {
		name = ne_settings.1.e1        #leave the menu,changes done
		
		trigger = {
		
			OR = {
				has_global_flag = names_chosen
				has_global_flag = SSR_chosen
			}
		
		}
	
		hidden_effect = {
			country_event = ne_settings_intro.2
		}
		
	}	
}


##############USA/Soviet Union Name settings#####################

country_event = {
	id = ne_settings.3
	title = ne_settings.3.t
	desc =  ne_settings.3.d
	picture = GFX_report_event_soviet_invasion_map
	
	is_triggered_only = yes
	
	
	option = {	##short versions
		name = ne_settings.3.a
		custom_effect_tooltip = ussr_usa_settings_a
		
		trigger = {		
			NOT = { has_global_flag = USA_USSR_Long }
			NOT = { has_global_flag = USA_USSR_Short }
		}
		
		SOV = { set_cosmetic_tag = NE_USS }
		USA = { set_cosmetic_tag = NE_USA }
		
		hidden_effect = {
			set_global_flag = USA_USSR_Short
			country_event = ne_settings_intro.2
		}		

	}
	
	
	option = { 	##long versions
		name = ne_settings.3.b
		custom_effect_tooltip = ussr_usa_settings_b
		
		trigger = {		
			NOT = { has_global_flag = USA_USSR_Long }
			NOT = { has_global_flag = USA_USSR_Short }
		}
		
		SOV = { set_cosmetic_tag = NE_USS_1 }
		USA = { set_cosmetic_tag = NE_USA_1 }
		
		hidden_effect = {
			set_global_flag = USA_USSR_Long
			country_event = ne_settings_intro.2

		}
		
	}
	
	
	option = { 	# Disable the names!
		name = ne_settings.3.e
		##NEW TOOLTIP NEEDED
		#custom_effect_tooltip = ussr_usa_settings_c
		
		trigger = {
			OR = {
				has_global_flag = USA_USSR_Short
				has_global_flag = USA_USSR_Long		
			}		
		}
		
			if = {
				limit = {
					has_global_flag = USA_USSR_Short		
				}
				clr_global_flag = USA_USSR_Short
				SOV = { clr_country_flag = NE_USS_option }
			}
				
			if = {
				limit = {
					has_global_flag = USA_USSR_Long		
				}
				clr_global_flag = USA_USSR_Long
				SOV = { clr_country_flag = NE_USS_1_option }
			}
			
			
			SOV = {drop_cosmetic_tag = yes } 
			USA = {drop_cosmetic_tag = yes }

		hidden_effect = {
			country_event = ne_settings_intro.2
		}
		
	}

	
	option = { # NO, return to menu with no changes
		name = ne_settings.3.c
		custom_effect_tooltip = ussr_usa_settings_c
		
		trigger = {
			NOT = {
				has_global_flag = USA_USSR_Short
				has_global_flag = USA_USSR_Long		
			}		
		}
		
		hidden_effect = {
			country_event = ne_settings_intro.2
		}
		
	}

	option = { # NO, return to menu WITH changes
		name = ne_settings.3.c1
		custom_effect_tooltip = ussr_usa_settings_c
	
			trigger = {
					OR = {
						has_global_flag = USA_USSR_Short
						has_global_flag = USA_USSR_Long		
					}		
				}
			
				hidden_effect = {
					country_event = ne_settings_intro.2
				}
			
			}

	   
}



##############Neutrality Settings and Faction Settings#####################

country_event = {
	id = ne_settings.2
	title = ne_settings.2.t
	desc =  ne_settings.2.d
	picture = GFX_report_event_soviet_invasion_map
	
	is_triggered_only = yes
	
	##Enable the neutrality settings
	option = {
		name = ne_settings.2.a
		
		trigger = {		
			NOT = { has_global_flag = Neutrality_chosen }		
		}

			TUR = {add_ideas = NE_neutrality}
			SWE = {add_ideas = NE_neutrality}
			SWI = {add_ideas = NE_neutrality}
			IRE = {add_ideas = NE_neutrality}
			SPR = {add_ideas = NE_neutrality}
			JAP = {add_ideas = NE_neutrality}
			##Can not join factions during winter war; but during Barbarossa
			FIN = {add_timed_idea = { idea = NE_neutrality days = 1400} }
			
			
			hidden_effect = {
				set_global_flag = Neutrality_chosen
				country_event = ne_settings_intro.3
			}	
	
	}
	

	option = { # NO
		name = ne_settings.2.b
		
		trigger = {		
			has_global_flag = Neutrality_chosen 		
		}
		
			TUR = {remove_ideas = NE_neutrality}
			SWE = {remove_ideas = NE_neutrality}
			SWI = {remove_ideas = NE_neutrality}
			IRE = {remove_ideas = NE_neutrality}			
			FIN = {remove_ideas = NE_neutrality}
			SPR = {remove_ideas = NE_neutrality}
			JAP = {remove_ideas = NE_neutrality}

		
		hidden_effect = {
			clr_global_flag = Neutrality_chosen
			country_event = ne_settings_intro.3
		}
		
	}

	option = { # Return to menu
	name = ne_settings.2.c
	
	
		hidden_effect = {
			country_event = ne_settings_intro.3
		}
	} 

}


##############Stricter Rules for NATO/WARSAW PACT#####################//NOT FULLY IMPLEMENTED

country_event = {
	id = ne_settings.4
	title = ne_settings.4.t
	desc =  ne_settings.4.d
	picture = GFX_report_event_soviet_invasion_map
	
	is_triggered_only = yes

	option = {
		name = ne_settings.4.a
		#custom_effect_tooltip = tooltip 
		
		trigger = {
			NOT = { has_global_flag = ne_strict_faction	}	
		}
		
			set_global_flag = ne_strict_faction
			
			##reduce popularity support in some countries
			##event to remove american guarantee when guaranteed country is communist with 80% support
		
		hidden_effect = {
			country_event = ne_settings_intro.3
		}
	
	}
	
	option = {
		name = ne_settings.4.a1
		#custom_effect_tooltip = tooltip 
		
		trigger = {
			has_global_flag = ne_strict_faction		
		}
		
		clr_global_flag = ne_strict_faction
		
		hidden_effect = {
			country_event = ne_settings_intro.1
		}
	
	}
	
	
	option = { ##just co-properity
		name = ne_settings.4.b
		
		trigger = {
			NOT = { has_global_flag = CPS_created }	
		}

		JAP = { 
			create_faction = "coprosperity_sphere" 
			add_to_faction = MAN
			add_to_faction = MEN
		}
		
		hidden_effect = {
			set_global_flag = CPS_created
			country_event = ne_settings_intro.3		
		}

	}
	
	option = { ##delete co-properity sphere
		name = ne_settings.4.b1
		
		trigger = {
			has_global_flag = CPS_created 
		}
		
		##Greater East Asia Co-Prosperity Sphere
		JAP = { 
			dismantle_faction = yes
			remove_from_faction = MAN
			remove_from_faction = MEN 
		}
		
		hidden_effect = {
			clr_global_flag = CPS_created
			country_event = ne_settings_intro.3		
		}

	}

	
	
	option = { ##don't change anything, return to menu
		name = ne_settings.4.e
		
		hidden_effect = {
			country_event = ne_settings_intro.3
		}
		
	}
			
                  
}


##Misc-Settings
country_event = {
	id = ne_settings.5
	title = ne_settings.5.t
	desc =  ne_settings.5.d
	picture = GFX_report_event_soviet_invasion_map
	
	is_triggered_only = yes
	
	##CHECK
	option = {		##Enable puppet SSRs
		name = ne_settings.5.a
		#custom_effect_tooltip = tooltip 
		
			trigger = {
				NOT = { has_global_flag = ne_puppet_ssr	}	
			}
			
			##release SSRs
			release = BLR
			release = UKR
			release = AZR
			release = ARM
			release = GEO
			release = KAZ
			release = TRK
			release = TAJ
			release = KGZ
			release = UZB

			
			##puppet SSRs
			SOV = {

				if = {			
					limit = {
						has_dlc = "Together for Victory"
					}
					
					set_autonomy = {
						target = BLR
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = UKR
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = MOL
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = ARM
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = GEO
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = AZR
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = KAZ
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = UZB
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = TAJ
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = KGZ
						autonomous_state = autonomy_integrated_puppet
					}
					
					set_autonomy = {
						target = TRK
						autonomous_state = autonomy_integrated_puppet
					}
					
					else = {
						puppet = BLR
						puppet = UKR
						puppet = MOL
						puppet = ARM
						puppet = AZR
						puppet = GEO
						puppet = KAZ
						puppet = UZB
						puppet = TRK
						puppet = KGZ
						puppet = TAJ
					}
					
				}
			

				dismantle_faction = yes
				
				end_puppet = TAN
				end_puppet = MON 
				
				give_guarantee = TAN
				give_guarantee = MON
				
				create_faction = "soviet_union"
				add_to_faction = BLR
				add_to_faction = UKR
				add_to_faction = AZR
				add_to_faction = GEO
				add_to_faction = ARM
				add_to_faction = KAZ
				add_to_faction = UZB
				add_to_faction = TRK
				add_to_faction = TAJ
				add_to_faction = KGZ

			}
			
			
			
			
			set_global_flag = ne_puppet_ssr
			
		hidden_effect = {
			country_event = ne_settings_intro.1
		}
	
	}
	
	option = {		##Disable SSRs
		name = ne_settings.5.a1
		#custom_effect_tooltip = tooltip 
		
		trigger = {
			has_global_flag = ne_puppet_ssr		
		}

		
			clr_global_flag = ne_puppet_ssr
			
			SOV = {
			
				##annex	
				annex_country = { target = BLR } 
				annex_country = { target = UKR } 	
				annex_country = { target = MOL }  
				annex_country = { target = AZR } 	
				annex_country = { target = GEO }  
				annex_country = { target = ARM } 	
				annex_country = { target = KAZ }  
				annex_country = { target = KGZ }					
				annex_country = { target = TRK }
				annex_country = { target = UZB }
				annex_country = { target = TAJ }
				
				create_faction = "comintern"
				add_to_faction = TAN
				add_to_faction = MON
				
				drop_cosmetic_tag = yes
				
				if = {
					limit = {
						has_global_flag = USA_USSR_Short
					}
				set_cosmetic_tag = NE_USS
				}
				
				if = {
					limit = {
						has_global_flag = USA_USSR_Long
					}
				set_cosmetic_tag = NE_USS_1
				}
								
			}
			
			
		hidden_effect = {
			country_event = ne_settings_intro.1
		}
	
	}
	
	option = { ##add additional research slot for majors
		name = ne_settings.5.b
		
		trigger = {
			NOT = { has_global_flag = additional_rd_slot }
		}
		
			every_country = {
				limit = {
					is_major = yes
				}
			 	add_research_slot = 1	
			}
		
		hidden_effect = {
			country_event = ne_settings_intro.1
		}
		
	}
	
	option = { ##remove additional research slot for majors
		name = ne_settings.5.b1
		
		trigger = {
			as_global_flag = additional_rd_slot 
		}
		
			every_country = {
				limit = {
					is_major = yes
				}
			 	add_research_slot = -1	
			}
		
		hidden_effect = {
			clr_global_flag = additional_rd_slot
			country_event = ne_settings_intro.1
		}
		
	}

	
	option = { ##don't change anything, return to menu
		name = ne_settings.5.e
		
		hidden_effect = {
			country_event = ne_settings_intro.1
		}
		
	}
	
	
	
                  
}


